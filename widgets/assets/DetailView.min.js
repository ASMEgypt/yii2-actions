(function(){$.widget("execut.DetailView",{isDebug:false,buttonsEl:null,topOffset:null,sizesEl:null,_create:function(){var a=this;a._initElements();a._initEvents();a._initReloadedAttributes()},_initElements:function(){var a=this;a.formEl=a.element.parent();a.buttonsEl=a.element.find(".buttons-container");if(a.isDebug){a.sizesEl=$('<div style="display: inline-block; font-size: 6px"></div>');a.buttonsEl.prepend(a.sizesEl)}},_initialValueRefreshAttribute:null,_initReloadedAttributes:function(){var a=this;if(!a.options.reloadedAttributes.length){return}setTimeout(function(){a.reloadReloadedAttributes()},5000)},reloadReloadedAttributes:function(){var a=this;$.ajax({dataType:"json",url:location.href,data:{getReloadedAttributes:1},success:function(b){for(var c in b.rows){$("."+c).replaceWith(b.rows[c])}if(a.options.initialValueRefreshAttribute&&typeof b.refreshAttribute!=="undefined"){if(b.refreshAttribute!==a.options.initialValueRefreshAttribute){location.reload()}}setTimeout(function(){a.reloadReloadedAttributes()},5000)},headers:{"X-Pjax":1}})},isSaved:false,_initEvents:function(){var b=this,a=false;b.formEl.on("beforeValidate",function(f,g,c){var d=function(){b.formEl.unbind("ajaxComplete",d);if(a){b.element.loadingOverlay("remove");a=false}};b.formEl.on("ajaxComplete",d);if(!a){a=true;b.element.loadingOverlay({loadingText:"Загрузка.."})}});b.formEl.on("submit",function(d,f,c){if(!a){a=true;b.element.loadingOverlay({loadingText:"Загрузка.."})}});b.formEl.on("afterValidate",function(d,f,c){if(a){b.element.loadingOverlay("remove");a=false}});if(b.options.isFloatedButtons){setTimeout(function(){b.topOffset=null;b.initButtonsOffsetTop()},1000);b.initButtonsOffsetTop();$(window).on("scroll",function(){b.positionizeButtons()}).on("resize orientationchange",function(){b.initButtonsOffsetTop(true);b.positionizeButtons()});$(document).on("touchmove",function(){b.positionizeButtons()})}},initButtonsOffsetTop:function(a){var b=this;if(b.topOffset===null||a){b.topOffset=b.buttonsEl.css("bottom",false).removeClass("floated-buttons").offset().top+b.buttonsEl.outerHeight(true)}b.positionizeButtons()},positionizeButtons:function(){var b=this,c=$(window).scrollTop()+$(window).outerHeight()-b.topOffset+5,a=c<0;if(b.isDebug){b.sizesEl.html("Time: "+Date.now()+"<br>t.buttonsEl.parent().width(): "+Math.floor(b.buttonsEl.parent().width()))}if(a){b.buttonsEl.addClass("floated-buttons")}else{b.buttonsEl.removeClass("floated-buttons")}b.buttonsEl.css("width",Math.floor(b.buttonsEl.parent().width()))}})})();